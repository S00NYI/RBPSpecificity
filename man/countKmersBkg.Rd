% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrichment.R
\name{countKmersBkg}
\alias{countKmersBkg}
\title{Calculate Average K-mer Counts from Background Sets}
\usage{
countKmersBkg(
  original_peak_gr,
  K,
  type = "DNA",
  genome_obj,
  Bkg_dist = 500,
  Bkg_number = 100,
  max_shift_dist = 1000,
  internal_min_length_for_bkg_seqs = K
)
}
\arguments{
\item{original_peak_gr}{A GRanges object representing the initial peaks from
which background regions are derived.}

\item{K}{Integer, the length of K-mers to count.}

\item{type}{Character string, "DNA" or "RNA" (case-insensitive), defining the
alphabet for K-mer generation. Passed to `countKmers` and used to
generate the K-mer universe. Default: "DNA".}

\item{genome_obj}{A BSgenome object for sequence retrieval by `generateBkgSet`.}

\item{Bkg_dist}{Integer, the minimum absolute distance (in base pairs) for
shifting peaks. Passed to `generateBkgSet`. Default: 500.}

\item{Bkg_number}{Integer, the number of background iterations to perform.
Default: 100.}

\item{max_shift_dist}{Integer, the maximum absolute distance (in base pairs)
for shifting peaks. Passed to `generateBkgSet`. Default: 1000.}

\item{internal_min_length_for_bkg_seqs}{Integer, minimum length for sequences
generated by `generateBkgSet` (passed as `K` to `generateBkgSet` which
passes it as `min_length` to `getSequence`). Default is `K` from this function.}
}
\value{
A data frame with two columns: 'MOTIF' (all possible K-mers for the
  specified type and K, in uppercase) and 'AVG_BKG_COUNT' (the average count
  of each K-mer across all background iterations, rounded).
  Returns a data frame with 0 counts if no valid background sequences
  could be generated across all iterations.
}
\description{
This function calculates the average K-mer counts over multiple
  iterations of background sequence generation. For each iteration, it generates
  a new set of background sequences using `generateBkgSet`, counts K-mers
  using `countKmers`, and then averages these counts across all iterations.
}
\keyword{#}
\keyword{Helper}
\keyword{for}
\keyword{function}
\keyword{internal}
\keyword{main}
\keyword{motifEnrichment}
\keyword{the}
