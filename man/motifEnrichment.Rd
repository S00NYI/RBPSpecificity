% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrichment.R
\name{motifEnrichment}
\alias{motifEnrichment}
\title{Calculate K-mer Motif Enrichment from Genomic Coordinates}
\usage{
motifEnrichment(
  coordinates,
  species_or_build,
  K,
  extension = c(0, 0),
  enrichment_method = "subtract",
  normalization_method = "min_max",
  log_transform = TRUE,
  bkg_iter = 100,
  bkg_min_dist = 500,
  bkg_max_dist = 1000,
  nucleic_acid_type = "DNA",
  ...
)
}
\arguments{
\item{coordinates}{A data frame or GRanges object containing genomic coordinates.
If a data frame, it must contain columns for chromosome, start, and end.}

\item{species_or_build}{Character string identifying the genome build (e.g.,
"hg38", "mm10"). This is used to load the appropriate BSgenome package.}

\item{K}{Integer, the length of the K-mers to analyze (e.g., 5).}

\item{extension}{A numeric vector of length 2: `c(five_prime, three_prime)`.
Positive values extend, negative values trim. Extension/trimming is strand-aware.
Default: `c(0, 0)` (no change).}

\item{enrichment_method}{Character string, the method for calculating enrichment.
Supported: "subtract" (default), "fold_change", "log2_fold_change".}

\item{normalization_method}{Character string, the method for normalizing the final
enrichment scores. Supported: "min_max" (default), "z_score", "log2", "none".}

\item{log_transform}{Logical, if TRUE, applies a log transformation after scaling,
mimicking the original analysis script's method (min-max to [1,e] then log).
If FALSE, performs only the specified `normalization_method`. Default: TRUE.}

\item{bkg_iter}{Integer, the number of background iterations to perform for averaging.
Default: 100.}

\item{bkg_min_dist}{Integer, the minimum distance (in base pairs) to shift peaks when
creating background regions. Default: 500.}

\item{bkg_max_dist}{Integer, the maximum distance for shifting peaks. Default: 1000.}

\item{nucleic_acid_type}{Character string, "DNA" or "RNA". Determines the alphabet
for K-mer generation. Default: "DNA".}

\item{...}{Additional arguments passed to `normalizeScores()` (e.g., `a=0, b=1`
for min-max normalization).}
}
\value{
A data frame containing two columns: 'MOTIF' (all possible K-mers) and
  'Score' (the final, normalized enrichment score).
}
\description{
This is the main workflow function for the RBPSpecificity package. It processes
RBP binding peak data (e.g., from eCLIP experiments) to calculate normalized,
background-corrected enrichment scores for all K-mers of a given length.
}
\details{
The workflow proceeds as follows:
1.  Parses input coordinate data into a standardized GRanges object.
2.  Loads the specified BSgenome object for sequence retrieval.
3.  Extracts sequences for peak regions, applying optional extension/trimming.
4.  Counts K-mers within the peak sequences.
5.  Generates an averaged K-mer profile from multiple background sets. Background
    sets are created by shifting and scrambling genomic regions.
6.  Calculates enrichment scores by comparing peak counts to background counts.
7.  Normalizes the final enrichment scores to a standard scale.
}
\examples{
\dontrun{
# This is a conceptual example, as it requires real data and a BSgenome package.
# Assume 'my_coords_df' is a data frame with chr, start, end columns.

enrichment_results <- motifEnrichment(
  coordinates = my_coords_df,
  species_or_build = "hg38",
  K = 5,
  extension = c(25, 0),  # Extend 25nt from 5'-end only
  enrichment_method = "subtract",
  normalization_method = "min_max"
)

head(enrichment_results)
}
}
